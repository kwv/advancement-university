<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ELIZA — 1966</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #111;
    color: #f5e6c8;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    height: 100vh;
    display: flex;
    flex-direction: column;
  }
  #header {
    background: #1a1a1a;
    border-bottom: 1px solid #333;
    padding: 6px 12px;
    font-size: 11px;
    color: #d4a017;
    letter-spacing: 0.05em;
  }
  #log {
    flex: 1;
    overflow-y: auto;
    padding: 10px 12px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .msg {
    padding: 3px 0;
    line-height: 1.5;
  }
  .msg.eliza { color: #7ec8a0; }
  .msg.user  { color: #f5e6c8; }
  .msg.user::before  { content: '> '; color: #d4a017; }
  .msg.eliza::before { content: 'ELIZA: '; color: #7ec8a0; font-weight: bold; }
  #input-row {
    display: flex;
    border-top: 1px solid #333;
    background: #1a1a1a;
  }
  #prompt-label {
    padding: 8px 10px;
    color: #d4a017;
    user-select: none;
  }
  #input {
    flex: 1;
    background: transparent;
    border: none;
    color: #f5e6c8;
    font-family: inherit;
    font-size: 13px;
    padding: 8px 4px;
    outline: none;
  }
  #send {
    background: #2c2c2c;
    border: none;
    border-left: 1px solid #333;
    color: #d4a017;
    padding: 0 14px;
    cursor: pointer;
    font-family: inherit;
    font-size: 12px;
  }
  #send:hover { background: #3a3a3a; }
</style>
</head>
<body>
<div id="header">ELIZA &mdash; MIT Artificial Intelligence Lab, 1966 &mdash; DOCTOR script</div>
<div id="log"></div>
<div id="input-row">
  <span id="prompt-label">&gt;</span>
  <input id="input" type="text" placeholder="Say something..." autocomplete="off" />
  <button id="send">Send</button>
</div>

<script>
// Minimal ELIZA implementation — DOCTOR script
// Based on Weizenbaum (1966). Pattern matching only — no AI, no learning.

var rules = [
  { weight: 10, pattern: /\b(i am|i'm)\s+(.*)/i, responses: [
    "How long have you been {2}?",
    "Why do you say you are {2}?",
    "Do you believe it is normal to be {2}?",
  ]},
  { weight: 9, pattern: /\bi feel\s+(.*)/i, responses: [
    "Tell me more about feeling {1}.",
    "Do you often feel {1}?",
    "When do you usually feel {1}?",
  ]},
  { weight: 8, pattern: /\bi (want|need|wish)\s+(.*)/i, responses: [
    "Why do you {1} {2}?",
    "What would it mean to you if you got {2}?",
    "Suppose you got {2} — what then?",
  ]},
  { weight: 7, pattern: /\bmy\s+(.*)/i, responses: [
    "Tell me more about your {1}.",
    "Why do you bring up your {1}?",
    "Does that have anything to do with the fact that your {1}?",
  ]},
  { weight: 6, pattern: /\byou are\s+(.*)/i, responses: [
    "What makes you think I am {1}?",
    "Does it please you to believe I am {1}?",
    "Why do you say I am {1}?",
  ]},
  { weight: 5, pattern: /\bbecause\b(.*)/i, responses: [
    "Is that the real reason?",
    "Are there other reasons?",
    "Does that reason apply to anything else?",
  ]},
  { weight: 5, pattern: /\b(yes)\b/i, responses: [
    "You seem quite positive.",
    "You are sure.",
    "I see. Please go on.",
  ]},
  { weight: 5, pattern: /\b(no)\b/i, responses: [
    "Are you saying no just to be negative?",
    "Why not?",
    "Why 'no'?",
  ]},
  { weight: 4, pattern: /\b(computer|machine|robot|ai|artificial intelligence)\b/i, responses: [
    "Do computers worry you?",
    "Are you talking about me in particular?",
    "Do you think machines can think?",
    "What do you think machines are missing?",
  ]},
  { weight: 4, pattern: /\b(always|never)\b/i, responses: [
    "Can you think of a specific example?",
    "Really — always?",
    "When?",
  ]},
  { weight: 3, pattern: /\b(alike|similar|same)\b/i, responses: [
    "In what way?",
    "What resemblance do you see?",
  ]},
  { weight: 2, pattern: /\b(hello|hi|hey)\b/i, responses: [
    "Hello. How are you feeling today?",
    "Hi there. What is on your mind?",
  ]},
  { weight: 1, pattern: /.*/, responses: [
    "Please go on.",
    "I see. Tell me more.",
    "That is interesting. Can you elaborate?",
    "I'm not sure I understand — can you rephrase?",
    "What do you mean by that?",
    "And how does that make you feel?",
    "Go on.",
  ]},
];

var memory = [];

function reflect(str) {
  // Swap first/second person pronouns for natural responses
  return str
    .replace(/\byou\b/gi, 'I')
    .replace(/\byour\b/gi, 'my')
    .replace(/\byours\b/gi, 'mine')
    .replace(/\bme\b/gi, 'you')
    .replace(/\bmy\b/gi, 'your')
    .replace(/\bmine\b/gi, 'yours')
    .replace(/\bi am\b/gi, 'you are')
    .replace(/\bi'm\b/gi, 'you are')
    .replace(/\bI\b/g, 'you');
}

function pick(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

var counters = {};

function eliza(input) {
  input = input.trim();
  if (!input) return "Please say something.";

  for (var i = 0; i < rules.length; i++) {
    var rule = rules[i];
    var m = input.match(rule.pattern);
    if (m) {
      var key = i + ':' + (counters[i] || 0);
      counters[i] = ((counters[i] || 0) + 1) % rule.responses.length;
      var resp = rule.responses[counters[i]];
      // Replace {1}, {2} with reflected capture groups
      resp = resp.replace(/\{(\d+)\}/g, function(_, n) {
        var cap = m[parseInt(n)] || '';
        return reflect(cap.trim());
      });
      return resp;
    }
  }
  return pick(["Please go on.", "I see.", "Tell me more."]);
}

// --- UI ---
var log = document.getElementById('log');
var input = document.getElementById('input');
var send = document.getElementById('send');

function addMsg(text, who) {
  var div = document.createElement('div');
  div.className = 'msg ' + who;
  div.textContent = text;
  log.appendChild(div);
  log.scrollTop = log.scrollHeight;
}

function submit() {
  var text = input.value.trim();
  if (!text) return;
  addMsg(text, 'user');
  input.value = '';
  setTimeout(function() {
    addMsg(eliza(text), 'eliza');
  }, 180);
}

send.addEventListener('click', submit);
input.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') submit();
});

addMsg("Hello. How are you feeling today?", 'eliza');
input.focus();
</script>
</body>
</html>
